### 三角波比較法によるVVVFインバータプログラムです。 ハイサイド側の信号しか生成していませんが、一応ローサイドのできると思います。（使用ピンはちゃんと見ないと起動時にリセットしまくる。） その際にデッドタイムの生成はないので注意してください。 タイマー割り込み周波数は20kHz、ディスプレイ表示などは未実装です。

3+6nパルスの生成は大丈夫ですが、5パルスなどの生成がうまくできてません。（左右非対称） 電圧のV/f一定制御もできていません。


### 位相の操作方法について
正弦波（変調波）の位相は1周期を2^31として細かく周波数で刻めるようにしました。この値が小さいと出せる周波数が少なくなります。（ここまで大きくなくてもよかった感はある（？））
　具体的には、特定の周波数では一回の割り込みでどれだけ位相を進めればよい、という値を配列に格納しています。

例)　５Hzの正弦波を使いたい　→　一回の割り込みで進める位相は
２^３１　×　５（Hz）÷　割り込み周波数（Hz）
で計算します。
これを使いたい正弦波の周波数ごとに対応させて配列に格納します。
今回は正弦波を201Hzまで0.1刻みで用意したので、配列はint型で長さは2010となっています。
三角波についても同様ですが、三角波はそこまで細かく刻む必要はないので、1Hz刻みで3000Hzまでの長さ3000の配列として作成しました。

　今回2^31という値を使用したのには別の理由も少しあります。全部参考にさせていただいたサイトに書いてあるのですが、２の累乗の値を使うことで簡単に剰余の計算が行えるのです。
剰余の計算では通常、除算という過程があるのでどうしても演算速度が遅くなります。しかし２の累乗で割るような場合はAND演算をしてあげるだけで実現できます。

### 位相に対応した値の取り出し方
　次に、位相に対応した正弦波や三角波の値を取り出さなくてはならないのですが、2^31などという膨大な大きさの配列を作成すると簡単にリソース不足となるので、圧縮みたいなことをします。
　具体的には、位相に対応した値を格納する配列の大きさを2^11として小さめにします。そして最大2^31である位相の値を、20bit分右にビットシフトさせます。つまり最大2^31である位相の値の下位20bitを切り捨てた値を使います。この操作によって2^11の位相のうちの対応する位相が分かります。

### 好きな音を出したいときは...
三角波の周波数の音が大体出るので三角波の周波数をいじります。

### 電圧の変更は...
三角波の振幅は一定として、正弦波の振幅を変更して変えてやります。

## 実装したプログラムの説明

#### タイマー割り込み関数
まず割り込み関数で行うことですが、（割り込みは20kHzで行いました。これ以上は無理でした。）主に、正弦波と三角波の位相について出したい周波数に対応した値が代入された変数（dPhi_sin,dPhi_triとしました）があるので、それをその時の位相を保存している変数（sin_pahse, tri_phase）に足します。次に、三相すべてについてその位相に対応した正弦波の値と三角波の値を比較します。（SwithGPIOという自作関数）その比較でどっちが大きいかを見て、GPIOを操作してやります。

#### Setup関数
　ここでは主に使いたい配列の計算と格納、タイマーの登録を行います。

#### loop関数
　ここではコントローラーの入力値に応じて適切にspeedという変数を操作します。
どのくらいの加速なので、これくらいの頻度(delay())でspeedを大きくする。といった感じです。
コントローラはアナログ電圧で判断します。
